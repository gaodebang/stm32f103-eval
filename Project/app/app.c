/*
*********************************************************************************************************
*
*	模块名称 : ASP模块(For STM32F4XX)
*	文件名称 : asp.c
*	版    本 : V1.0
*	说    明 : 
*
*********************************************************************************************************
*/

#include "app.h"
#include "bsp.h"
#include "main.h"

WORK_MODE Sys_Work_Mode = SYS_POWER_ON;

/*
*********************************************************************************************************
*	函 数 名: trigger_deal
*	功能说明: 
*	形    参：无
*	返 回 值: 无
*********************************************************************************************************
*/
void trigger_deal(void)
{
	static uint16_t i;
	printf("%d\n",i++);
}

/*
*********************************************************************************************************
*	函 数 名: App_Init
*	功能说明: 
*	形    参：无
*	返 回 值: 无
*********************************************************************************************************
*/
void App_Init(void)
{
    
}

/*
*********************************************************************************************************
*	函 数 名: App_Task
*	功能说明: 
*	形    参：无
*	返 回 值: 无
*********************************************************************************************************
*/
void App_Task(void)
{
  static uint32_t sys_time, time_ms = 0, time_add_up = 0;
	
	DISABLE_INT();  	/* 关中断 */
	sys_time = Sys_Time;	/* 这个变量在Systick中断中被改写，因此需要关中断进行保护 */
	ENABLE_INT();  		/* 开中断 */
	
	if(time_ms != sys_time)
	{
		time_ms = sys_time;
		if(++time_add_up >= 1000)
		{
			time_add_up = 0;
			trigger_deal();
		}
	}
}

